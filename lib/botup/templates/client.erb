module <%= class_name %>
  class Client
    def initialize(token)
      @token = token
    end

    def start
      begin
        respond
      rescue Telegram::Bot::Exceptions::ResponseError => exception
        puts exception
        sleep 1
        retry # run again on telegram server error
      end
    end

    private

    attr_reader :token

    def respond
      Telegram::Bot::Client.run(token) do |bot|
        bot.listen do |message|
          next unless message.text

          Responder.new(api: bot.api, message: message).call
        end
      end
    end
  end
end
